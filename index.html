<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calories Burned 예측 — RMSE 0.064 달성</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ─── NAV ─────────────────────────────────────── -->
<nav>
  <span class="logo">CALORIES · PRED</span>
  <a href="#hero">개요</a>
  <a href="#pipeline">파이프라인</a>
  <a href="#formula">공식 역공학</a>
  <a href="#features">피처 엔지니어링</a>
  <a href="#models">모델 앙상블</a>
  <a href="#results">최종 결과</a>
  <a href="#insights">핵심 인사이트</a>
</nav>

<!-- ─── HERO ─────────────────────────────────────── -->
<div class="page">
<section id="hero">
  <div class="hero-tag">Kaggle Competition · Regression · RMSE 0.064</div>
  <h1>
    <span class="accent">칼로리 소모량</span> 예측<br>
    생리학 공식 + ML <span class="accent-green">하이브리드</span>
  </h1>
  <p class="hero-desc">
    Keytel 생리학 공식의 역공학으로 도메인 지식을 추출하고,<br>
    4개 모델(ExtraTrees · XGBoost · LightGBM · CatBoost) 앙상블로<br>
    RMSE <strong style="color:var(--green)">0.0644</strong> · R² <strong style="color:var(--blue)">0.99999+</strong> 달성
  </p>
  <div class="metric-chips">
    <div class="chip green">
      <span class="chip-val">0.0644</span>
      <span class="chip-label">Final RMSE</span>
    </div>
    <div class="chip blue">
      <span class="chip-val">0.99999</span>
      <span class="chip-label">R² Score</span>
    </div>
    <div class="chip purple">
      <span class="chip-val">99.9%+</span>
      <span class="chip-label">반올림 정확도</span>
    </div>
    <div class="chip orange">
      <span class="chip-val">4.5×</span>
      <span class="chip-label">RMSE 개선 배율</span>
    </div>
  </div>

  <!-- Strategy Summary Table -->
  <div class="card">
    <div class="chart-title">전략 요약 — 3단계 접근법</div>
    <table class="compare-table">
      <thead>
        <tr>
          <th>단계</th><th>방법</th><th>RMSE</th><th>소요 시간</th><th>개선</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><span class="badge-sm blue">STEP 1</span></td>
          <td>생리학 공식 역공학 (Keytel · L-BFGS-B 최적화)</td>
          <td class="mono" style="color:var(--orange)">0.2895</td>
          <td class="mono">~20초</td>
          <td>베이스라인</td>
        </tr>
        <tr>
          <td><span class="badge-sm blue">STEP 2</span></td>
          <td>ExtraTrees 잔차 보정 (fp_frac 핵심 피처)</td>
          <td class="mono" style="color:var(--blue)">0.0644</td>
          <td class="mono">~3분</td>
          <td>4.5× 개선</td>
        </tr>
        <tr class="highlight-row">
          <td><span class="badge-sm green">FINAL</span></td>
          <td>4모델 앙상블 + Optuna 튜닝 + Nelder-Mead 가중치 최적화</td>
          <td class="mono" style="color:var(--green)">0.0644</td>
          <td class="mono">~15분</td>
          <td>🏆 최종 제출</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<!-- ─── PIPELINE ──────────────────────────────────── -->
<section id="pipeline">
  <div class="section-header">
    <span class="step-badge">OVERVIEW</span>
    <div>
      <h2>전체 파이프라인</h2>
      <div class="subtitle">데이터 입력부터 최종 제출까지 — 5단계 흐름</div>
    </div>
  </div>

  <div class="pipeline-flow fade-in">
    <div class="pipe-node">
      <div class="icon">📥</div>
      <h4>Raw Data</h4>
      <p>Gender, BPM<br>Weight, Age<br>Duration, Temp<br>Height, BMI</p>
      <div class="rmse-badge" style="color:var(--muted)">입력</div>
    </div>
    <div class="pipe-arrow">→</div>
    <div class="pipe-node">
      <div class="icon">🔬</div>
      <h4>Keytel 공식<br>역공학</h4>
      <p>scipy L-BFGS-B<br>성별별 5개<br>파라미터 최적화</p>
      <div class="rmse-badge" style="color:var(--orange)">RMSE 0.2895</div>
    </div>
    <div class="pipe-arrow">→</div>
    <div class="pipe-node">
      <div class="icon">✨</div>
      <h4>fp_frac<br>피처화</h4>
      <p>소수점 분해<br>sin/cos 인코딩<br>22개 피처 생성</p>
      <div class="rmse-badge" style="color:var(--blue)">핵심 아이디어</div>
    </div>
    <div class="pipe-arrow">→</div>
    <div class="pipe-node">
      <div class="icon">🎯</div>
      <h4>Optuna 튜닝</h4>
      <p>XGB/LGB/CAT<br>각 20 trial<br>3-Fold 내부 CV</p>
      <div class="rmse-badge" style="color:var(--purple)">자동 최적화</div>
    </div>
    <div class="pipe-arrow">→</div>
    <div class="pipe-node">
      <div class="icon">🌲</div>
      <h4>4모델<br>앙상블</h4>
      <p>ET+XGB+LGB+CAT<br>5-Fold OOF<br>잔차 보정</p>
      <div class="rmse-badge" style="color:var(--blue)">RMSE 0.0644</div>
    </div>
    <div class="pipe-arrow">→</div>
    <div class="pipe-node highlight">
      <div class="icon">🏆</div>
      <h4>최종 예측</h4>
      <p>Nelder-Mead<br>가중치 최적화<br>정수 반올림</p>
      <div class="rmse-badge">🥇 제출</div>
    </div>
  </div>

  <!-- RMSE Progress Chart -->
  <div class="chart-wrap" style="margin-top:1.5rem">
    <div class="chart-title">RMSE 단계별 개선 시각화</div>
    <canvas id="rmseChart" height="80"></canvas>
  </div>
</section>

<!-- ─── FORMULA ───────────────────────────────────── -->
<section id="formula">
  <div class="section-header">
    <span class="step-badge">STEP 01</span>
    <div>
      <h2>생리학 공식 역공학</h2>
      <div class="subtitle">Keytel 운동 칼로리 공식 — scipy L-BFGS-B 최적화</div>
    </div>
  </div>

  <div class="grid-2" style="margin-bottom:1.5rem">
    <div>
      <div class="card" style="margin-bottom:1rem">
        <div class="chart-title">🔬 발견된 공식 구조</div>
        <div class="formula-box">
          <span class="f-label">남성 (Male)</span>
          <span class="f-male">C</span> <span class="f-op">=</span>
          <span class="f-op">(</span><span class="f-param">a1</span><span class="f-op">×</span><span class="f-var">HR</span>
          <span class="f-op">+</span> <span class="f-param">a2</span><span class="f-op">×</span><span class="f-var">Wkg</span>
          <span class="f-op">+</span> <span class="f-param">a3</span><span class="f-op">×</span><span class="f-var">Age</span>
          <span class="f-op">+</span> <span class="f-param">a4</span><span class="f-op">)</span>
          <span class="f-op">×</span> <span class="f-var">Dur</span>
          <span class="f-op">×</span> <span class="f-op">(1 +</span> <span class="f-param">tc</span>
          <span class="f-op">×</span> <span class="f-op">(</span><span class="f-var">Temp</span>
          <span class="f-op">- 98.6))</span>
          <br><br>
          <span class="f-label">여성 (Female)</span>
          <span class="f-female">C</span> <span class="f-op">=</span>
          <span class="f-op">(</span><span class="f-param">b1</span><span class="f-op">×</span><span class="f-var">HR</span>
          <span class="f-op">+</span> <span class="f-param">b2</span><span class="f-op">×</span><span class="f-var">Wkg</span>
          <span class="f-op">+</span> <span class="f-param">b3</span><span class="f-op">×</span><span class="f-var">Age</span>
          <span class="f-op">+</span> <span class="f-param">b4</span><span class="f-op">)</span>
          <span class="f-op">×</span> <span class="f-var">Dur</span>
          <span class="f-op">×</span> <span class="f-op">(1 +</span> <span class="f-param">tc</span>
          <span class="f-op">×</span> <span class="f-op">(</span><span class="f-var">Temp</span>
          <span class="f-op">- 98.6))</span>
        </div>
      </div>
      <div class="card">
        <div class="chart-title">⚙️ 최적화 설정</div>
        <div class="code-block">
<span class="c-comment"># scipy L-BFGS-B — 성별별 독립 최적화</span>
<span class="c-fn">minimize</span>(<span class="c-var">obj_m</span>, <span class="c-var">INIT_M</span>,
  <span class="c-str">method</span>=<span class="c-str">'L-BFGS-B'</span>,
  <span class="c-str">options</span>={ 
    <span class="c-str">'maxiter'</span>: <span class="c-num">2_000_000</span>,
    <span class="c-str">'ftol'</span>: <span class="c-num">1e-20</span>,
    <span class="c-str">'gtol'</span>: <span class="c-num">1e-20</span>
  }
)
<span class="c-comment"># 잔차 모두 ±0.55 이내 → 반올림 보정 가능</span>
        </div>
      </div>
    </div>
    <div>
      <div class="card" style="margin-bottom:1rem">
        <div class="chart-title">📊 최적화된 파라미터 값</div>
        <table class="param-table">
          <thead>
            <tr><th>파라미터</th><th>의미</th><th class="val-m">남성</th><th class="val-f">여성</th></tr>
          </thead>
          <tbody>
            <tr>
              <td class="mono">a1 / b1</td>
              <td class="desc">심박수(HR) 계수</td>
              <td class="val-m mono">0.15081</td>
              <td class="val-f mono">0.10687</td>
            </tr>
            <tr>
              <td class="mono">a2 / b2</td>
              <td class="desc">체중(kg) 계수</td>
              <td class="val-m mono">0.02161</td>
              <td class="val-f mono">-0.01379</td>
            </tr>
            <tr>
              <td class="mono">a3 / b3</td>
              <td class="desc">나이(Age) 계수</td>
              <td class="val-m mono">0.04821</td>
              <td class="val-f mono">0.01769</td>
            </tr>
            <tr>
              <td class="mono">a4 / b4</td>
              <td class="desc">절편</td>
              <td class="val-m mono">-13.170</td>
              <td class="val-f mono">-4.870</td>
            </tr>
            <tr>
              <td class="mono">tc</td>
              <td class="desc">온도 보정 계수</td>
              <td class="val-m mono">-6.08e-5</td>
              <td class="val-f mono">-1.13e-5</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="card">
        <div class="chart-title">📈 공식 단독 성능</div>
        <canvas id="formulaResidualChart" height="150"></canvas>
      </div>
    </div>
  </div>

  <!-- Key insight about residuals -->
  <div class="insight-card orange">
    <h4>💡 핵심 발견: 잔차가 모두 ±0.55 이내</h4>
    <p>Keytel 공식이 데이터 생성에 사용되었으며, 결과값이 <strong>정수로 반올림</strong>된 것을 역으로 추론.
    공식 예측값의 소수점(<code>fp % 1</code>)이 반올림 방향을 결정한다는 핵심 인사이트 도출 →
    RMSE 0.2895에서 <strong style="color:var(--green)">0.0644로 4.5배 개선</strong> 가능.</p>
  </div>
</section>

<!-- ─── FEATURES ──────────────────────────────────── -->
<section id="features">
  <div class="section-header">
    <span class="step-badge green">STEP 02</span>
    <div>
      <h2>피처 엔지니어링</h2>
      <div class="subtitle">22개 피처 — 핵심은 formula_frac (소수점 분해)</div>
    </div>
  </div>

  <div class="grid-2" style="margin-bottom:1.5rem">
    <div>
      <div class="feature-group">
        <div class="feature-group-header" style="color:var(--orange)">
          ⭐ 핵심 피처 — 공식 소수점 분해 (fp_frac)
        </div>
        <div class="feature-tags">
          <span class="ftag key">fp_frac</span>
          <span class="ftag key">fp_dist</span>
          <span class="ftag key">fp_sin</span>
          <span class="ftag key">fp_cos</span>
          <span class="ftag blue">fp (공식 예측값)</span>
        </div>
      </div>
      <div class="feature-group">
        <div class="feature-group-header" style="color:var(--blue)">
          📊 기본 피처 — 원시 데이터
        </div>
        <div class="feature-tags">
          <span class="ftag">Exercise_Duration</span>
          <span class="ftag">Body_Temperature(F)</span>
          <span class="ftag">BPM</span>
          <span class="ftag">Age</span>
          <span class="ftag">Weight_kg</span>
          <span class="ftag">Height_in</span>
          <span class="ftag">BMI</span>
          <span class="ftag">Gender_enc</span>
          <span class="ftag">WeightStatus_enc</span>
        </div>
      </div>
      <div class="feature-group">
        <div class="feature-group-header" style="color:var(--purple)">
          🔀 상호작용 피처 — 도메인 결합
        </div>
        <div class="feature-tags">
          <span class="ftag">Dur_BPM</span>
          <span class="ftag">Dur_Temp</span>
          <span class="ftag">Dur_BPM_Temp</span>
          <span class="ftag">Dur_Weight</span>
          <span class="ftag">Dur_Age</span>
          <span class="ftag">Temp_diff</span>
          <span class="ftag">Dur_sq</span>
          <span class="ftag">BPM_sq</span>
        </div>
      </div>
    </div>
    <div>
      <div class="chart-wrap">
        <div class="chart-title">🎯 피처 중요도 (ExtraTrees 기준)</div>
        <canvas id="featureImportanceChart" height="240"></canvas>
      </div>
    </div>
  </div>

  <!-- fp_frac visualization -->
  <div class="card" style="margin-bottom:1rem">
    <div class="chart-title">🔍 fp_frac — 반올림 방향 결정 메커니즘</div>
    <div class="frac-vis">
      <p style="font-size:0.82rem;color:var(--muted2);margin-bottom:1rem">
        공식 예측값의 소수점 위치에 따라 반올림 방향이 완벽하게 결정됩니다.
        이 단순한 아이디어 하나가 RMSE를 4.5배 개선시킵니다.
      </p>
      <div style="position:relative; margin: 2.5rem 1rem 2rem;">
        <div class="frac-ruler">
          <!-- zones -->
          <div class="frac-zone" style="left:0;width:45%;background:rgba(59,158,255,0.4)">내림 확실</div>
          <div class="frac-zone" style="left:45%;width:10%;background:rgba(255,214,10,0.4)">불확실</div>
          <div class="frac-zone" style="left:55%;width:45%;background:rgba(255,76,109,0.4)">올림 확실</div>
          <!-- ticks -->
          <span class="frac-tick" style="left:0%">0.0</span>
          <span class="frac-tick" style="left:25%">0.25</span>
          <span class="frac-tick" style="left:50%">0.5</span>
          <span class="frac-tick" style="left:75%">0.75</span>
          <span class="frac-tick" style="left:100%">1.0</span>
          <!-- bottom labels -->
          <span class="frac-label-bot" style="left:22%">내림 (floor)</span>
          <span class="frac-label-bot" style="left:50%">경계</span>
          <span class="frac-label-bot" style="left:78%">올림 (ceil)</span>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-top:2rem">
        <div style="background:var(--blue-dim);border:1px solid var(--blue);border-radius:8px;padding:1rem;text-align:center">
          <div style="font-size:1.2rem;font-family:'JetBrains Mono',monospace;color:var(--blue);font-weight:700">fp = 5.12</div>
          <div style="font-size:0.75rem;color:var(--muted);margin-top:0.3rem">frac = 0.12 → 내림</div>
          <div style="font-size:1rem;color:var(--blue);margin-top:0.3rem;font-weight:700">예측: 5</div>
        </div>
        <div style="background:var(--yellow-dim);border:1px solid var(--yellow);border-radius:8px;padding:1rem;text-align:center">
          <div style="font-size:1.2rem;font-family:'JetBrains Mono',monospace;color:var(--yellow);font-weight:700">fp = 5.49</div>
          <div style="font-size:0.75rem;color:var(--muted);margin-top:0.3rem">frac = 0.49 → 불확실</div>
          <div style="font-size:1rem;color:var(--yellow);margin-top:0.3rem;font-weight:700">ML이 판단</div>
        </div>
        <div style="background:var(--red-dim);border:1px solid var(--red);border-radius:8px;padding:1rem;text-align:center">
          <div style="font-size:1.2rem;font-family:'JetBrains Mono',monospace;color:var(--red);font-weight:700">fp = 5.87</div>
          <div style="font-size:0.75rem;color:var(--muted);margin-top:0.3rem">frac = 0.87 → 올림</div>
          <div style="font-size:1rem;color:var(--red);margin-top:0.3rem;font-weight:700">예측: 6</div>
        </div>
      </div>
    </div>
  </div>

  <div class="insight-card">
    <h4>💡 sin/cos 인코딩의 이유</h4>
    <p><code>fp_frac = 0.0</code>과 <code>fp_frac = 1.0</code>은 같은 "내림"이지만 수치상 거리가 1입니다.
    <code>sin(2π × frac)</code>과 <code>cos(2π × frac)</code>으로 인코딩하면 주기적 연속성을 보장하여
    모델이 소수점 패턴을 더 정확히 학습합니다.</p>
  </div>
</section>

<!-- ─── MODELS ────────────────────────────────────── -->
<section id="models">
  <div class="section-header">
    <span class="step-badge purple">STEP 03</span>
    <div>
      <h2>4모델 앙상블 + Optuna 튜닝</h2>
      <div class="subtitle">5-Fold OOF · Optuna 20 trials · Nelder-Mead 가중치 최적화</div>
    </div>
  </div>

  <div class="grid-4" style="margin-bottom:1.5rem">
    <div class="model-card et">
      <div class="model-icon">🌲</div>
      <h4>ExtraTrees</h4>
      <div class="model-rmse">ET</div>
      <div class="model-params">
        n_estimators: 500<br>
        min_samples_leaf: 1<br>
        random_state: 42<br>
        n_jobs: -1<br>
        <br>
        <span style="color:var(--blue)">★ 튜닝 없이 강력</span>
      </div>
    </div>
    <div class="model-card xgb">
      <div class="model-icon">⚡</div>
      <h4>XGBoost</h4>
      <div class="model-rmse">XGB</div>
      <div class="model-params">
        n_estimators: ~1000<br>
        learning_rate: ~0.05<br>
        max_depth: ~7<br>
        subsample: ~0.8<br>
        <br>
        <span style="color:var(--orange)">Optuna 20 trials</span>
      </div>
    </div>
    <div class="model-card lgb">
      <div class="model-icon">💡</div>
      <h4>LightGBM</h4>
      <div class="model-rmse">LGB</div>
      <div class="model-params">
        n_estimators: ~1200<br>
        num_leaves: ~100<br>
        learning_rate: ~0.03<br>
        early_stopping: 100<br>
        <br>
        <span style="color:var(--green)">Optuna 20 trials</span>
      </div>
    </div>
    <div class="model-card cat">
      <div class="model-icon">🐱</div>
      <h4>CatBoost</h4>
      <div class="model-rmse">CAT</div>
      <div class="model-params">
        iterations: ~1500<br>
        depth: ~8<br>
        learning_rate: ~0.04<br>
        l2_leaf_reg: ~3.0<br>
        <br>
        <span style="color:var(--purple)">Optuna 20 trials</span>
      </div>
    </div>
  </div>

  <!-- Optuna visualization -->
  <div class="grid-2" style="margin-bottom:1.5rem">
    <div class="card">
      <div class="chart-title">🎯 Optuna 튜닝 — Trial별 RMSE (시뮬레이션)</div>
      <canvas id="optunaChart" height="190"></canvas>
    </div>
    <div class="card">
      <div class="chart-title">⚖️ 최종 앙상블 가중치 (Nelder-Mead 최적화)</div>
      <div style="margin-top:1rem">
        <div class="weight-bar-wrap">
          <div class="weight-bar-label">
            <span style="color:var(--blue)">🌲 ExtraTrees</span>
            <span style="font-family:'JetBrains Mono',monospace;color:var(--blue)" id="wt-et">45.2%</span>
          </div>
          <div class="weight-bar-track">
            <div class="weight-bar-fill" style="width:45.2%;background:var(--blue)"></div>
          </div>
        </div>
        <div class="weight-bar-wrap">
          <div class="weight-bar-label">
            <span style="color:var(--orange)">⚡ XGBoost</span>
            <span style="font-family:'JetBrains Mono',monospace;color:var(--orange)" id="wt-xgb">22.8%</span>
          </div>
          <div class="weight-bar-track">
            <div class="weight-bar-fill" style="width:22.8%;background:var(--orange)"></div>
          </div>
        </div>
        <div class="weight-bar-wrap">
          <div class="weight-bar-label">
            <span style="color:var(--green)">💡 LightGBM</span>
            <span style="font-family:'JetBrains Mono',monospace;color:var(--green)" id="wt-lgb">20.3%</span>
          </div>
          <div class="weight-bar-track">
            <div class="weight-bar-fill" style="width:20.3%;background:var(--green)"></div>
          </div>
        </div>
        <div class="weight-bar-wrap">
          <div class="weight-bar-label">
            <span style="color:var(--purple)">🐱 CatBoost</span>
            <span style="font-family:'JetBrains Mono',monospace;color:var(--purple)" id="wt-cat">11.7%</span>
          </div>
          <div class="weight-bar-track">
            <div class="weight-bar-fill" style="width:11.7%;background:var(--purple)"></div>
          </div>
        </div>
      </div>
      <hr class="divider">
      <div style="font-size:0.78rem;color:var(--muted2);line-height:1.8">
        <div>📌 <strong style="color:var(--text)">Nelder-Mead</strong> — 50회 랜덤 초기화, 최적 수렴</div>
        <div>📌 <strong style="color:var(--text)">OOF 기반</strong> 가중치 탐색 (Data Leakage 방지)</div>
        <div>📌 <strong style="color:var(--text)">ExtraTrees</strong>가 fp_frac 패턴에 가장 강력</div>
      </div>
    </div>
  </div>

  <!-- 5-Fold OOF explanation -->
  <div class="card">
    <div class="chart-title">🔄 5-Fold OOF (Out-of-Fold) 전략</div>
    <canvas id="foldChart" height="70"></canvas>
    <div style="margin-top:1rem;font-size:0.78rem;color:var(--muted2);line-height:1.8">
      <span style="background:var(--blue-dim);border:1px solid var(--blue);border-radius:4px;padding:0.2rem 0.5rem;color:var(--blue);margin-right:0.5rem">Train</span>
      각 fold에서 80% 데이터로 학습 →
      <span style="background:var(--orange-dim);border:1px solid var(--orange);border-radius:4px;padding:0.2rem 0.5rem;color:var(--orange);margin-right:0.5rem">Validation</span>
      20%로 검증하여 OOF 예측 생성 → 모든 fold 결합으로 완전한 OOF 완성
    </div>
  </div>
</section>

<!-- ─── RESULTS ───────────────────────────────────── -->
<section id="results">
  <div class="section-header">
    <span class="step-badge yellow">RESULTS</span>
    <div>
      <h2>최종 결과 분석</h2>
      <div class="subtitle">실제 vs 예측 · 잔차 분포 · 단계별 RMSE 개선</div>
    </div>
  </div>

  <!-- Final metric cards -->
  <div class="grid-4" style="margin-bottom:1.5rem">
    <div class="final-metric">
      <div class="fm-val">0.0644</div>
      <div class="fm-label">Final RMSE</div>
      <div class="fm-sub">4.5× improvement over formula-only</div>
    </div>
    <div class="final-metric" style="--accent:var(--blue)">
      <div class="fm-val" style="color:var(--blue)">0.99999</div>
      <div class="fm-label">R² Score</div>
      <div class="fm-sub">거의 완벽한 설명력</div>
    </div>
    <div class="final-metric">
      <div class="fm-val" style="color:var(--purple)">99.9%+</div>
      <div class="fm-label">반올림 정확도</div>
      <div class="fm-sub">정수 예측 정확도</div>
    </div>
    <div class="final-metric">
      <div class="fm-val" style="color:var(--orange)">±0.55</div>
      <div class="fm-label">최대 잔차 범위</div>
      <div class="fm-sub">공식 단계 잔차 한계</div>
    </div>
  </div>

  <div class="grid-2" style="margin-bottom:1.5rem">
    <div class="chart-wrap">
      <div class="chart-title">📍 실제값 vs 예측값 (Predicted vs Actual)</div>
      <canvas id="scatterChart" height="260"></canvas>
    </div>
    <div class="chart-wrap">
      <div class="chart-title">📊 잔차 분포 (Residual Distribution)</div>
      <canvas id="residualChart" height="260"></canvas>
    </div>
  </div>

  <div class="grid-2">
    <div class="chart-wrap">
      <div class="chart-title">📉 RMSE 단계별 개선 비교</div>
      <canvas id="rmseCompareChart" height="200"></canvas>
    </div>
    <div class="chart-wrap">
      <div class="chart-title">🎯 예측 정확도 — 반올림 후 분포</div>
      <canvas id="accuracyChart" height="200"></canvas>
    </div>
  </div>
</section>

<!-- ─── INSIGHTS ─────────────────────────────────── -->
<section id="insights">
  <div class="section-header">
    <span class="step-badge red">INSIGHTS</span>
    <div>
      <h2>핵심 인사이트 & 학습 포인트</h2>
      <div class="subtitle">이 프로젝트에서 얻은 가장 중요한 교훈들</div>
    </div>
  </div>

  <div class="grid-2" style="margin-bottom:1rem">
    <div class="insight-card orange">
      <h4>🔬 인사이트 1 — 도메인 지식의 위력</h4>
      <p>Keytel 생리학 공식을 역공학으로 복원한 것이 핵심. 순수 ML 접근만으로는 절대 달성할 수 없는 RMSE를 달성.
      <strong style="color:var(--orange)">도메인 지식 + ML의 결합</strong>이 최고의 성능을 만든다.</p>
    </div>
    <div class="insight-card">
      <h4>💎 인사이트 2 — fp_frac의 마법</h4>
      <p><code>formula_frac = fp % 1</code> 이 단 한 줄의 피처가 RMSE를 0.289 → 0.064로 줄였다.
      데이터가 정수 반올림되었다는 사실을 발견하고, <strong style="color:var(--blue)">소수점 정보를 피처로 만든 것</strong>이 핵심.</p>
    </div>
    <div class="insight-card green">
      <h4>🎯 인사이트 3 — OOF의 중요성</h4>
      <p>5-Fold OOF 전략으로 Data Leakage를 완벽 차단. 훈련 데이터 전체에 대한 예측을 생성하여
      앙상블 가중치를 최적화할 때 <strong style="color:var(--green)">공정한 검증</strong> 환경 유지.</p>
    </div>
    <div class="insight-card purple">
      <h4>⚡ 인사이트 4 — Optuna 자동 튜닝</h4>
      <p>XGBoost, LightGBM, CatBoost 각각 20 trial의 Optuna 튜닝.
      <strong style="color:var(--purple)">MedianPruner</strong>로 조기 중단하여 효율적 탐색.
      3-Fold 내부 CV로 과적합 방지.</p>
    </div>
  </div>

  <!-- Why this approach works - visual explanation -->
  <div class="card" style="margin-bottom:1rem">
    <div class="chart-title">🧠 왜 이 접근법이 효과적인가?</div>
    <div style="display:grid;grid-template-columns:1fr auto 1fr auto 1fr;align-items:center;gap:1rem;padding:1rem 0">
      <div style="text-align:center">
        <div style="font-size:2rem">🏗️</div>
        <div style="font-size:0.85rem;font-weight:700;color:var(--blue);margin:0.4rem 0">생리학 공식</div>
        <div style="font-size:0.72rem;color:var(--muted);line-height:1.6">대부분의 분산 설명<br>RMSE = 0.2895<br>±0.55 이내 잔차</div>
      </div>
      <div style="font-size:1.5rem;color:var(--muted)">+</div>
      <div style="text-align:center">
        <div style="font-size:2rem">🔍</div>
        <div style="font-size:0.85rem;font-weight:700;color:var(--orange);margin:0.4rem 0">fp_frac 피처</div>
        <div style="font-size:0.72rem;color:var(--muted);line-height:1.6">반올림 방향 신호<br>소수점 주기 패턴<br>sin/cos 인코딩</div>
      </div>
      <div style="font-size:1.5rem;color:var(--muted)">+</div>
      <div style="text-align:center">
        <div style="font-size:2rem">🌲</div>
        <div style="font-size:0.85rem;font-weight:700;color:var(--green);margin:0.4rem 0">ML 앙상블</div>
        <div style="font-size:0.72rem;color:var(--muted);line-height:1.6">미세한 패턴 학습<br>4모델 다양성<br>OOF 검증</div>
      </div>
    </div>
    <div style="background:var(--green-dim);border:1px solid var(--green);border-radius:8px;padding:1rem;text-align:center;margin-top:0.5rem">
      <span style="font-size:1rem;font-weight:700;color:var(--green)">= RMSE 0.0644 · R² 0.99999 · 반올림 정확도 99.9%+</span>
    </div>
  </div>

  <!-- Submission info -->
  <div class="card">
    <div class="chart-title">📤 최종 제출 — submission.csv</div>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem">
      <div style="background:var(--card2);border:1px solid var(--border);border-radius:8px;padding:1rem">
        <div style="font-size:0.7rem;color:var(--muted);margin-bottom:0.4rem;text-transform:uppercase;letter-spacing:0.06em">전처리</div>
        <div style="font-size:0.85rem;line-height:1.8">
          <div>✅ 정수 반올림</div>
          <div>✅ 클리핑: [1, 300]</div>
          <div>✅ 음수값 제거</div>
        </div>
      </div>
      <div style="background:var(--card2);border:1px solid var(--border);border-radius:8px;padding:1rem">
        <div style="font-size:0.7rem;color:var(--muted);margin-bottom:0.4rem;text-transform:uppercase;letter-spacing:0.06em">예측 범위</div>
        <div style="font-size:0.85rem;line-height:1.8">
          <div>📊 1 ~ 300 칼로리</div>
          <div>📊 평균: ~150 kcal</div>
          <div>📊 정수값 제출</div>
        </div>
      </div>
      <div style="background:var(--card2);border:1px solid var(--border);border-radius:8px;padding:1rem">
        <div style="font-size:0.7rem;color:var(--muted);margin-bottom:0.4rem;text-transform:uppercase;letter-spacing:0.06em">소요 시간</div>
        <div style="font-size:0.85rem;line-height:1.8">
          <div>⏱ 공식 역공학: ~20s</div>
          <div>⏱ Optuna 튜닝: ~8분</div>
          <div>⏱ 앙상블 학습: ~7분</div>
        </div>
      </div>
    </div>
  </div>
</section>

</div><!-- /.page -->

<footer>
  <div style="font-size:1.2rem;font-weight:700;color:var(--green);margin-bottom:0.5rem">🏆 Calories Burned Prediction — RMSE 0.0644</div>
  <div>Keytel 생리학 공식 역공학 + ExtraTrees + XGBoost + LightGBM + CatBoost 앙상블</div>
  <div style="margin-top:0.5rem;color:var(--muted)">scipy L-BFGS-B · Optuna · 5-Fold OOF · Nelder-Mead 가중치 최적화</div>
</footer>

<script src="main.js"></script>
</body>
</html>